{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "c92864ba",
   "metadata": {},
   "source": [
    "## Preparing for Data Scraping"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3c25b631",
   "metadata": {},
   "source": [
    "Public Data Source: https://www.seoul.go.kr/coronaV/coronaStatus.do"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 455,
   "id": "669dab12",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 456,
   "id": "e135e3cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "import requests"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 457,
   "id": "dd35e344",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'https://news.seoul.go.kr/api/27/getCorona19Status/get_status_ajax.php?draw=1&start=0&length=100'"
      ]
     },
     "execution_count": 457,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "url = \"https://news.seoul.go.kr/api/27/getCorona19Status/get_status_ajax.php?draw=1\"\n",
    "#url = f\"{url}&columns%5B0%5D%5Bdata%5D=0&columns%5B0%5D%5Bname%5D=&columns%5B0%5D%5Bsearchable%5D=true&columns%5B0%5D%5Borderable%5D=true&columns%5B0%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B0%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B1%5D%5Bdata%5D=1&columns%5B1%5D%5Bname%5D=&columns%5B1%5D%5Bsearchable%5D=true&columns%5B1%5D%5Borderable%5D=true&columns%5B1%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B1%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B2%5D%5Bdata%5D=2&columns%5B2%5D%5Bname%5D=&columns%5B2%5D%5Bsearchable%5D=true&columns%5B2%5D%5Borderable%5D=true&columns%5B2%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B2%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B3%5D%5Bdata%5D=3&columns%5B3%5D%5Bname%5D=&columns%5B3%5D%5Bsearchable%5D=true&columns%5B3%5D%5Borderable%5D=true&columns%5B3%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B3%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B4%5D%5Bdata%5D=4&columns%5B4%5D%5Bname%5D=&columns%5B4%5D%5Bsearchable%5D=true&columns%5B4%5D%5Borderable%5D=true&columns%5B4%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B4%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B5%5D%5Bdata%5D=5&columns%5B5%5D%5Bname%5D=&columns%5B5%5D%5Bsearchable%5D=true&columns%5B5%5D%5Borderable%5D=true&columns%5B5%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B5%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B6%5D%5Bdata%5D=6&columns%5B6%5D%5Bname%5D=&columns%5B6%5D%5Bsearchable%5D=true&columns%5B6%5D%5Borderable%5D=true&columns%5B6%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B6%5D%5Bsearch%5D%5Bregex%5D=false&order%5B0%5D%5Bcolumn%5D=0&order%5B0%5D%5Bdir%5D=desc\"\n",
    "url = f\"{url}&start=0&length=100\"\n",
    "#\"&search%5Bvalue%5D=&search%5Bregex%5D=true&_=1628930508535\"\n",
    "url"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 458,
   "id": "812bfc30",
   "metadata": {},
   "outputs": [],
   "source": [
    "response = requests.get(url)\n",
    "data_json = response.json()\n",
    "# pd.DataFrame(data_json['data'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 459,
   "id": "d15d8a14",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "40870"
      ]
     },
     "execution_count": 459,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "records_total = data_json['recordsTotal']\n",
    "records_total"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 460,
   "id": "2bf92d38",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "410"
      ]
     },
     "execution_count": 460,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "end_page = round(records_total/ 100) + 1\n",
    "end_page                                        # used in get_multi_page_list function"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 461,
   "id": "e8adf8b4",
   "metadata": {},
   "outputs": [],
   "source": [
    "data = data_json[\"data\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 462,
   "id": "9d7abc8d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70870&lt;/p&gt;</td>\n",
       "      <td>222111</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>기타</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70869&lt;/p&gt;</td>\n",
       "      <td>221232</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>기타</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70868&lt;/p&gt;</td>\n",
       "      <td>221356</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>성북구</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70867&lt;/p&gt;</td>\n",
       "      <td>221710</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>동대문구</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70866&lt;/p&gt;</td>\n",
       "      <td>220502</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>타시도</td>\n",
       "      <td>-</td>\n",
       "      <td>기타 확진자 접촉</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70775&lt;/p&gt;</td>\n",
       "      <td>221585</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>은평구</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70774&lt;/p&gt;</td>\n",
       "      <td>221083</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>동작구</td>\n",
       "      <td>-</td>\n",
       "      <td>기타 확진자 접촉</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70773&lt;/p&gt;</td>\n",
       "      <td>221319</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>동작구</td>\n",
       "      <td>-</td>\n",
       "      <td>수도권 소재 실내체육시설 관련</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70772&lt;/p&gt;</td>\n",
       "      <td>221342</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>동작구</td>\n",
       "      <td>-</td>\n",
       "      <td>기타 확진자 접촉</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70771&lt;/p&gt;</td>\n",
       "      <td>221590</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>은평구</td>\n",
       "      <td>-</td>\n",
       "      <td>기타 확진자 접촉</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   0       1           2     3  4  \\\n",
       "0   <p class='corona19_no'>70870</p>  222111  2021-08-13    기타  -   \n",
       "1   <p class='corona19_no'>70869</p>  221232  2021-08-13    기타  -   \n",
       "2   <p class='corona19_no'>70868</p>  221356  2021-08-13   성북구  -   \n",
       "3   <p class='corona19_no'>70867</p>  221710  2021-08-13  동대문구  -   \n",
       "4   <p class='corona19_no'>70866</p>  220502  2021-08-13   타시도  -   \n",
       "..                               ...     ...         ...   ... ..   \n",
       "95  <p class='corona19_no'>70775</p>  221585  2021-08-13   은평구  -   \n",
       "96  <p class='corona19_no'>70774</p>  221083  2021-08-13   동작구  -   \n",
       "97  <p class='corona19_no'>70773</p>  221319  2021-08-13   동작구  -   \n",
       "98  <p class='corona19_no'>70772</p>  221342  2021-08-13   동작구  -   \n",
       "99  <p class='corona19_no'>70771</p>  221590  2021-08-13   은평구  -   \n",
       "\n",
       "                   5                  6  \n",
       "0           감염경로 조사중  <b class=''>-</b>  \n",
       "1           감염경로 조사중  <b class=''>-</b>  \n",
       "2           감염경로 조사중  <b class=''>-</b>  \n",
       "3           감염경로 조사중  <b class=''>-</b>  \n",
       "4          기타 확진자 접촉  <b class=''>-</b>  \n",
       "..               ...                ...  \n",
       "95          감염경로 조사중  <b class=''>-</b>  \n",
       "96         기타 확진자 접촉  <b class=''>-</b>  \n",
       "97  수도권 소재 실내체육시설 관련  <b class=''>-</b>  \n",
       "98         기타 확진자 접촉  <b class=''>-</b>  \n",
       "99         기타 확진자 접촉  <b class=''>-</b>  \n",
       "\n",
       "[100 rows x 7 columns]"
      ]
     },
     "execution_count": 462,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.DataFrame(data)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "06d28897",
   "metadata": {},
   "source": [
    "## Function for scraping one pages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 463,
   "id": "10fa6df2",
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_seoul_covid19_100(page_no):\n",
    "    start_no = (page_no - 1) * 100\n",
    "    url = f\"https://news.seoul.go.kr/api/27/getCorona19Status/get_status_ajax.php?draw={page_no}\"\n",
    "    url = f\"{url}&start={start_no}&length=100\"\n",
    "    response = requests.get(url)\n",
    "    data_json = response.json()\n",
    "    return data_json"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 464,
   "id": "b7669471",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'draw': 1,\n",
       " 'recordsTotal': 40870,\n",
       " 'recordsFiltered': 40870,\n",
       " 'data': [[\"<p class='corona19_no'>70870</p>\",\n",
       "   '222111',\n",
       "   '2021-08-13',\n",
       "   '기타',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70869</p>\",\n",
       "   '221232',\n",
       "   '2021-08-13',\n",
       "   '기타',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70868</p>\",\n",
       "   '221356',\n",
       "   '2021-08-13',\n",
       "   '성북구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70867</p>\",\n",
       "   '221710',\n",
       "   '2021-08-13',\n",
       "   '동대문구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70866</p>\",\n",
       "   '220502',\n",
       "   '2021-08-13',\n",
       "   '타시도',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70865</p>\",\n",
       "   '220262',\n",
       "   '2021-08-13',\n",
       "   '동대문구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70864</p>\",\n",
       "   '221253',\n",
       "   '2021-08-13',\n",
       "   '타시도',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70863</p>\",\n",
       "   '221252',\n",
       "   '2021-08-13',\n",
       "   '타시도',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70862</p>\",\n",
       "   '220223',\n",
       "   '2021-08-13',\n",
       "   '광진구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70861</p>\",\n",
       "   '221555',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70860</p>\",\n",
       "   '221156',\n",
       "   '2021-08-13',\n",
       "   '타시도',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70859</p>\",\n",
       "   '220999',\n",
       "   '2021-08-13',\n",
       "   '관악구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70858</p>\",\n",
       "   '220856',\n",
       "   '2021-08-13',\n",
       "   '관악구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70857</p>\",\n",
       "   '220854',\n",
       "   '2021-08-13',\n",
       "   '관악구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70856</p>\",\n",
       "   '220714',\n",
       "   '2021-08-13',\n",
       "   '관악구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70855</p>\",\n",
       "   '220996',\n",
       "   '2021-08-13',\n",
       "   '관악구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70854</p>\",\n",
       "   '220989',\n",
       "   '2021-08-13',\n",
       "   '관악구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70853</p>\",\n",
       "   '221311',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70852</p>\",\n",
       "   '221547',\n",
       "   '2021-08-13',\n",
       "   '강동구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70851</p>\",\n",
       "   '221698',\n",
       "   '2021-08-13',\n",
       "   '중구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70850</p>\",\n",
       "   '221648',\n",
       "   '2021-08-13',\n",
       "   '타시도',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70849</p>\",\n",
       "   '222027',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70848</p>\",\n",
       "   '221443',\n",
       "   '2021-08-13',\n",
       "   '타시도',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70847</p>\",\n",
       "   '221985',\n",
       "   '2021-08-13',\n",
       "   '관악구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70846</p>\",\n",
       "   '221073',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   \"용산구 소재 직장 관련('21.8.)\",\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70845</p>\",\n",
       "   '221860',\n",
       "   '2021-08-13',\n",
       "   '중구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70844</p>\",\n",
       "   '221986',\n",
       "   '2021-08-13',\n",
       "   '노원구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70843</p>\",\n",
       "   '221485',\n",
       "   '2021-08-13',\n",
       "   '구로구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70842</p>\",\n",
       "   '221964',\n",
       "   '2021-08-13',\n",
       "   '마포구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70841</p>\",\n",
       "   '220283',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70840</p>\",\n",
       "   '222002',\n",
       "   '2021-08-13',\n",
       "   '광진구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70839</p>\",\n",
       "   '222000',\n",
       "   '2021-08-13',\n",
       "   '광진구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70838</p>\",\n",
       "   '221828',\n",
       "   '2021-08-13',\n",
       "   '중구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70837</p>\",\n",
       "   '221961',\n",
       "   '2021-08-13',\n",
       "   '중구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70836</p>\",\n",
       "   '221774',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70835</p>\",\n",
       "   '222023',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70834</p>\",\n",
       "   '221874',\n",
       "   '2021-08-13',\n",
       "   '중구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70833</p>\",\n",
       "   '221535',\n",
       "   '2021-08-13',\n",
       "   '용산구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70832</p>\",\n",
       "   '221857',\n",
       "   '2021-08-13',\n",
       "   '종로구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70831</p>\",\n",
       "   '221847',\n",
       "   '2021-08-13',\n",
       "   '강동구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70830</p>\",\n",
       "   '220852',\n",
       "   '2021-08-13',\n",
       "   '관악구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70829</p>\",\n",
       "   '221800',\n",
       "   '2021-08-13',\n",
       "   '강남구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70828</p>\",\n",
       "   '221855',\n",
       "   '2021-08-13',\n",
       "   '강동구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70827</p>\",\n",
       "   '221813',\n",
       "   '2021-08-13',\n",
       "   '서초구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70826</p>\",\n",
       "   '221814',\n",
       "   '2021-08-13',\n",
       "   '서초구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70825</p>\",\n",
       "   '221537',\n",
       "   '2021-08-13',\n",
       "   '서대문구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70824</p>\",\n",
       "   '221577',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70823</p>\",\n",
       "   '221758',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70822</p>\",\n",
       "   '221842',\n",
       "   '2021-08-13',\n",
       "   '중구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70821</p>\",\n",
       "   '221824',\n",
       "   '2021-08-13',\n",
       "   '종로구',\n",
       "   '-',\n",
       "   '중랑구 소재 교육시설 관련',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70820</p>\",\n",
       "   '221853',\n",
       "   '2021-08-13',\n",
       "   '종로구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70819</p>\",\n",
       "   '221678',\n",
       "   '2021-08-13',\n",
       "   '종로구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70818</p>\",\n",
       "   '221330',\n",
       "   '2021-08-13',\n",
       "   '용산구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70817</p>\",\n",
       "   '221749',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70816</p>\",\n",
       "   '221747',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70815</p>\",\n",
       "   '221550',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   \"용산구 소재 직장 관련('21.8.)\",\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70814</p>\",\n",
       "   '221732',\n",
       "   '2021-08-13',\n",
       "   '서대문구',\n",
       "   '미국',\n",
       "   '해외유입',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70813</p>\",\n",
       "   '221656',\n",
       "   '2021-08-13',\n",
       "   '강남구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70812</p>\",\n",
       "   '221580',\n",
       "   '2021-08-13',\n",
       "   '서대문구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70811</p>\",\n",
       "   '221211',\n",
       "   '2021-08-13',\n",
       "   '타시도',\n",
       "   '-',\n",
       "   '병원 및 요양시설',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70810</p>\",\n",
       "   '221549',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70809</p>\",\n",
       "   '221540',\n",
       "   '2021-08-13',\n",
       "   '구로구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70808</p>\",\n",
       "   '221677',\n",
       "   '2021-08-13',\n",
       "   '성북구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70807</p>\",\n",
       "   '221536',\n",
       "   '2021-08-13',\n",
       "   '관악구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70806</p>\",\n",
       "   '222105',\n",
       "   '2021-08-13',\n",
       "   '강동구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70805</p>\",\n",
       "   '221476',\n",
       "   '2021-08-13',\n",
       "   '강남구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70804</p>\",\n",
       "   '221517',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70803</p>\",\n",
       "   '221475',\n",
       "   '2021-08-13',\n",
       "   '강남구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70802</p>\",\n",
       "   '221371',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70801</p>\",\n",
       "   '221147',\n",
       "   '2021-08-13',\n",
       "   '타시도',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70800</p>\",\n",
       "   '220634',\n",
       "   '2021-08-13',\n",
       "   '용산구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70799</p>\",\n",
       "   '221552',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70798</p>\",\n",
       "   '221688',\n",
       "   '2021-08-13',\n",
       "   '강남구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70797</p>\",\n",
       "   '221235',\n",
       "   '2021-08-13',\n",
       "   '구로구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70796</p>\",\n",
       "   '221421',\n",
       "   '2021-08-13',\n",
       "   '타시도',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70795</p>\",\n",
       "   '221368',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70794</p>\",\n",
       "   '221496',\n",
       "   '2021-08-13',\n",
       "   '광진구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70793</p>\",\n",
       "   '221617',\n",
       "   '2021-08-13',\n",
       "   '강남구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70792</p>\",\n",
       "   '222025',\n",
       "   '2021-08-13',\n",
       "   '강남구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70791</p>\",\n",
       "   '221573',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70790</p>\",\n",
       "   '221586',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70789</p>\",\n",
       "   '222107',\n",
       "   '2021-08-13',\n",
       "   '관악구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70788</p>\",\n",
       "   '221863',\n",
       "   '2021-08-13',\n",
       "   '중구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70787</p>\",\n",
       "   '221504',\n",
       "   '2021-08-13',\n",
       "   '구로구',\n",
       "   '-',\n",
       "   \"관악구 소재 음식점 관련('21.7.)\",\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70786</p>\",\n",
       "   '221669',\n",
       "   '2021-08-13',\n",
       "   '도봉구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70785</p>\",\n",
       "   '221344',\n",
       "   '2021-08-13',\n",
       "   '영등포구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70784</p>\",\n",
       "   '221317',\n",
       "   '2021-08-13',\n",
       "   '동작구',\n",
       "   '-',\n",
       "   \"동작구 소재 시장 관련('21.8.)\",\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70783</p>\",\n",
       "   '221347',\n",
       "   '2021-08-13',\n",
       "   '동작구',\n",
       "   '-',\n",
       "   '타시도 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70782</p>\",\n",
       "   '221345',\n",
       "   '2021-08-13',\n",
       "   '동작구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70781</p>\",\n",
       "   '221343',\n",
       "   '2021-08-13',\n",
       "   '동작구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70780</p>\",\n",
       "   '221338',\n",
       "   '2021-08-13',\n",
       "   '동작구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70779</p>\",\n",
       "   '221321',\n",
       "   '2021-08-13',\n",
       "   '동작구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70778</p>\",\n",
       "   '221558',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70777</p>\",\n",
       "   '221587',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70776</p>\",\n",
       "   '221899',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70775</p>\",\n",
       "   '221585',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   '감염경로 조사중',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70774</p>\",\n",
       "   '221083',\n",
       "   '2021-08-13',\n",
       "   '동작구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70773</p>\",\n",
       "   '221319',\n",
       "   '2021-08-13',\n",
       "   '동작구',\n",
       "   '-',\n",
       "   '수도권 소재 실내체육시설 관련',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70772</p>\",\n",
       "   '221342',\n",
       "   '2021-08-13',\n",
       "   '동작구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"],\n",
       "  [\"<p class='corona19_no'>70771</p>\",\n",
       "   '221590',\n",
       "   '2021-08-13',\n",
       "   '은평구',\n",
       "   '-',\n",
       "   '기타 확진자 접촉',\n",
       "   \"<b class=''>-</b>\"]]}"
      ]
     },
     "execution_count": 464,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# data available\n",
    "get_seoul_covid19_100(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 465,
   "id": "dbcc8d55",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'draw': -1, 'recordsTotal': 40870, 'recordsFiltered': 40870, 'data': []}"
      ]
     },
     "execution_count": 465,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# data unavailable\n",
    "get_seoul_covid19_100(-1)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "aef37043",
   "metadata": {},
   "source": [
    "## Python code for combining all pages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 466,
   "id": "614f851f",
   "metadata": {},
   "outputs": [],
   "source": [
    "# to prevent network demage\n",
    "import time\n",
    "# tqdm: process check\n",
    "from tqdm import trange"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 467,
   "id": "463c7720",
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_multi_page_list(start_page, end_page):\n",
    "    page_list = []\n",
    "    for page_no in trange(start_page, end_page + 1):\n",
    "        one_page = get_seoul_covid19_100(page_no)\n",
    "        # break when page is empty\n",
    "        if len(one_page['data']) > 0:\n",
    "            one_page = pd.DataFrame(one_page['data'])\n",
    "            page_list.append(one_page)\n",
    "        else:\n",
    "            return page_list\n",
    "    return page_list\n",
    "        \n",
    "    \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 468,
   "id": "c138e35d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "410"
      ]
     },
     "execution_count": 468,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "end_page"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 469,
   "id": "431fbec3",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|█████████▉| 409/410 [08:34<00:01,  1.26s/it]\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[                                   0       1           2     3  4  \\\n",
       " 0   <p class='corona19_no'>70870</p>  222111  2021-08-13    기타  -   \n",
       " 1   <p class='corona19_no'>70869</p>  221232  2021-08-13    기타  -   \n",
       " 2   <p class='corona19_no'>70868</p>  221356  2021-08-13   성북구  -   \n",
       " 3   <p class='corona19_no'>70867</p>  221710  2021-08-13  동대문구  -   \n",
       " 4   <p class='corona19_no'>70866</p>  220502  2021-08-13   타시도  -   \n",
       " ..                               ...     ...         ...   ... ..   \n",
       " 95  <p class='corona19_no'>70775</p>  221585  2021-08-13   은평구  -   \n",
       " 96  <p class='corona19_no'>70774</p>  221083  2021-08-13   동작구  -   \n",
       " 97  <p class='corona19_no'>70773</p>  221319  2021-08-13   동작구  -   \n",
       " 98  <p class='corona19_no'>70772</p>  221342  2021-08-13   동작구  -   \n",
       " 99  <p class='corona19_no'>70771</p>  221590  2021-08-13   은평구  -   \n",
       " \n",
       "                    5                  6  \n",
       " 0           감염경로 조사중  <b class=''>-</b>  \n",
       " 1           감염경로 조사중  <b class=''>-</b>  \n",
       " 2           감염경로 조사중  <b class=''>-</b>  \n",
       " 3           감염경로 조사중  <b class=''>-</b>  \n",
       " 4          기타 확진자 접촉  <b class=''>-</b>  \n",
       " ..               ...                ...  \n",
       " 95          감염경로 조사중  <b class=''>-</b>  \n",
       " 96         기타 확진자 접촉  <b class=''>-</b>  \n",
       " 97  수도권 소재 실내체육시설 관련  <b class=''>-</b>  \n",
       " 98         기타 확진자 접촉  <b class=''>-</b>  \n",
       " 99         기타 확진자 접촉  <b class=''>-</b>  \n",
       " \n",
       " [100 rows x 7 columns]]"
      ]
     },
     "execution_count": 469,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Test Code\n",
    "start_page = 1\n",
    "end_page = round(records_total/ 100) + 1\n",
    "# end_page = 205\n",
    "page_list = get_multi_page_list(start_page, end_page)\n",
    "page_list[:1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 470,
   "id": "8e365307",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(40870, 7)"
      ]
     },
     "execution_count": 470,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_all = pd.concat(page_list)\n",
    "df_all.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 471,
   "id": "26bb918b",
   "metadata": {},
   "outputs": [],
   "source": [
    "cols = ['Number','Patient','Confimed Date','Area','Travel History','Transmission Route','Status']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 472,
   "id": "212e466f",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_all.columns = cols"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 473,
   "id": "6b9f1312",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Number</th>\n",
       "      <th>Patient</th>\n",
       "      <th>Confimed Date</th>\n",
       "      <th>Area</th>\n",
       "      <th>Travel History</th>\n",
       "      <th>Transmission Route</th>\n",
       "      <th>Status</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70870&lt;/p&gt;</td>\n",
       "      <td>222111</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>기타</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70869&lt;/p&gt;</td>\n",
       "      <td>221232</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>기타</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70868&lt;/p&gt;</td>\n",
       "      <td>221356</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>성북구</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70867&lt;/p&gt;</td>\n",
       "      <td>221710</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>동대문구</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>&lt;p class='corona19_no'&gt;70866&lt;/p&gt;</td>\n",
       "      <td>220502</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>타시도</td>\n",
       "      <td>-</td>\n",
       "      <td>기타 확진자 접촉</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                             Number Patient Confimed Date  Area  \\\n",
       "0  <p class='corona19_no'>70870</p>  222111    2021-08-13    기타   \n",
       "1  <p class='corona19_no'>70869</p>  221232    2021-08-13    기타   \n",
       "2  <p class='corona19_no'>70868</p>  221356    2021-08-13   성북구   \n",
       "3  <p class='corona19_no'>70867</p>  221710    2021-08-13  동대문구   \n",
       "4  <p class='corona19_no'>70866</p>  220502    2021-08-13   타시도   \n",
       "\n",
       "  Travel History Transmission Route             Status  \n",
       "0              -           감염경로 조사중  <b class=''>-</b>  \n",
       "1              -           감염경로 조사중  <b class=''>-</b>  \n",
       "2              -           감염경로 조사중  <b class=''>-</b>  \n",
       "3              -           감염경로 조사중  <b class=''>-</b>  \n",
       "4              -          기타 확진자 접촉  <b class=''>-</b>  "
      ]
     },
     "execution_count": 473,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_all.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 474,
   "id": "e80b132b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(40870, 7)"
      ]
     },
     "execution_count": 474,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_all.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cf5a70d5",
   "metadata": {},
   "source": [
    "## Data Preprocessing"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ac702255",
   "metadata": {},
   "source": [
    "### Number and Status"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 475,
   "id": "41c51325",
   "metadata": {},
   "outputs": [],
   "source": [
    "import re\n",
    "def extract_number(num_string):\n",
    "    if type(num_string) == str:\n",
    "        num_string = num_string.replace(\"corona19\", \"\")\n",
    "        num = re.sub(\"[^0-9]\", \"\", num_string)\n",
    "        num = int(num)\n",
    "        return num\n",
    "    else:\n",
    "        return num_string"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 476,
   "id": "76044d2a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "7625"
      ]
     },
     "execution_count": 476,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_string = \"<p class='corona19_no'>7625</p>\"\n",
    "extract_number(num_string)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 477,
   "id": "067e315c",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_all['Number'] = df_all[\"Number\"].map(extract_number)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 478,
   "id": "7e0ddd16",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Number</th>\n",
       "      <th>Patient</th>\n",
       "      <th>Confimed Date</th>\n",
       "      <th>Area</th>\n",
       "      <th>Travel History</th>\n",
       "      <th>Transmission Route</th>\n",
       "      <th>Status</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>70870</td>\n",
       "      <td>222111</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>기타</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>70869</td>\n",
       "      <td>221232</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>기타</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>70868</td>\n",
       "      <td>221356</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>성북구</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>70867</td>\n",
       "      <td>221710</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>동대문구</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>70866</td>\n",
       "      <td>220502</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>타시도</td>\n",
       "      <td>-</td>\n",
       "      <td>기타 확진자 접촉</td>\n",
       "      <td>&lt;b class=''&gt;-&lt;/b&gt;</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Number Patient Confimed Date  Area Travel History Transmission Route  \\\n",
       "0   70870  222111    2021-08-13    기타              -           감염경로 조사중   \n",
       "1   70869  221232    2021-08-13    기타              -           감염경로 조사중   \n",
       "2   70868  221356    2021-08-13   성북구              -           감염경로 조사중   \n",
       "3   70867  221710    2021-08-13  동대문구              -           감염경로 조사중   \n",
       "4   70866  220502    2021-08-13   타시도              -          기타 확진자 접촉   \n",
       "\n",
       "              Status  \n",
       "0  <b class=''>-</b>  \n",
       "1  <b class=''>-</b>  \n",
       "2  <b class=''>-</b>  \n",
       "3  <b class=''>-</b>  \n",
       "4  <b class=''>-</b>  "
      ]
     },
     "execution_count": 478,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_all.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 479,
   "id": "c493bed7",
   "metadata": {},
   "outputs": [],
   "source": [
    "def extract_hangeul(origin_text):\n",
    "    subtract_text = re.sub(\"[^가-힣]\", \"\", origin_text)\n",
    "    return subtract_text"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 480,
   "id": "f61bb76f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'퇴원'"
      ]
     },
     "execution_count": 480,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "extract_hangeul(\"<b class='status1'>퇴원</b>\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 481,
   "id": "8b63da8a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'사망'"
      ]
     },
     "execution_count": 481,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "extract_hangeul(\"<b class='status2'>사망</b>\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 482,
   "id": "56b46828",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "''"
      ]
     },
     "execution_count": 482,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "extract_hangeul(\"<b class=''>-</b>\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 483,
   "id": "26be6a56",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<b class='status1'>퇴원</b>    32131\n",
       "<b class='status1'>-</b>      4991\n",
       "<b class=''>-</b>             3531\n",
       "<b class='status2'>사망</b>      117\n",
       "<b class='status2'>-</b>       100\n",
       "Name: Status, dtype: int64"
      ]
     },
     "execution_count": 483,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_all[\"Status\"].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 484,
   "id": "edfde80e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Number</th>\n",
       "      <th>Patient</th>\n",
       "      <th>Confimed Date</th>\n",
       "      <th>Area</th>\n",
       "      <th>Travel History</th>\n",
       "      <th>Transmission Route</th>\n",
       "      <th>Status</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>70870</td>\n",
       "      <td>222111</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>기타</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>70869</td>\n",
       "      <td>221232</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>기타</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>70868</td>\n",
       "      <td>221356</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>성북구</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>70867</td>\n",
       "      <td>221710</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>동대문구</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>70866</td>\n",
       "      <td>220502</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>타시도</td>\n",
       "      <td>-</td>\n",
       "      <td>기타 확진자 접촉</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65</th>\n",
       "      <td>30005</td>\n",
       "      <td>95804</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>송파구</td>\n",
       "      <td>-</td>\n",
       "      <td>타시도 확진자 접촉</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66</th>\n",
       "      <td>30004</td>\n",
       "      <td>95889</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>종로구</td>\n",
       "      <td>-</td>\n",
       "      <td>감염경로 조사중</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>67</th>\n",
       "      <td>30003</td>\n",
       "      <td>95799</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>중구</td>\n",
       "      <td>-</td>\n",
       "      <td>중구 소재 주점/음식점 관련</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>68</th>\n",
       "      <td>30002</td>\n",
       "      <td>95872</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>종로구</td>\n",
       "      <td>-</td>\n",
       "      <td>기타 확진자 접촉</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>30001</td>\n",
       "      <td>95806</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>송파구</td>\n",
       "      <td>-</td>\n",
       "      <td>기타 확진자 접촉</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>40870 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Number Patient Confimed Date  Area Travel History Transmission Route  \\\n",
       "0    70870  222111    2021-08-13    기타              -           감염경로 조사중   \n",
       "1    70869  221232    2021-08-13    기타              -           감염경로 조사중   \n",
       "2    70868  221356    2021-08-13   성북구              -           감염경로 조사중   \n",
       "3    70867  221710    2021-08-13  동대문구              -           감염경로 조사중   \n",
       "4    70866  220502    2021-08-13   타시도              -          기타 확진자 접촉   \n",
       "..     ...     ...           ...   ...            ...                ...   \n",
       "65   30005   95804    2021-03-14   송파구              -         타시도 확진자 접촉   \n",
       "66   30004   95889    2021-03-14   종로구              -           감염경로 조사중   \n",
       "67   30003   95799    2021-03-14    중구              -    중구 소재 주점/음식점 관련   \n",
       "68   30002   95872    2021-03-14   종로구              -          기타 확진자 접촉   \n",
       "69   30001   95806    2021-03-14   송파구              -          기타 확진자 접촉   \n",
       "\n",
       "         Status  \n",
       "0   Quarantined  \n",
       "1   Quarantined  \n",
       "2   Quarantined  \n",
       "3   Quarantined  \n",
       "4   Quarantined  \n",
       "..          ...  \n",
       "65    Recovered  \n",
       "66    Recovered  \n",
       "67    Recovered  \n",
       "68    Recovered  \n",
       "69    Recovered  \n",
       "\n",
       "[40870 rows x 7 columns]"
      ]
     },
     "execution_count": 484,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_all.loc[df_all[\"Status\"].str.contains(\"퇴원\"), \"Status\"] = \"Recovered\"\n",
    "df_all.loc[df_all[\"Status\"].str.contains(\"사망\"), \"Status\"] = \"Death\"\n",
    "df_all.loc[~df_all[\"Status\"].str.contains(\"Recovered|Death\"), \"Status\"] = \"Quarantined\"\n",
    "df_all"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 485,
   "id": "28834c1e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Number</th>\n",
       "      <th>Patient</th>\n",
       "      <th>Confimed Date</th>\n",
       "      <th>Area</th>\n",
       "      <th>Travel History</th>\n",
       "      <th>Transmission Route</th>\n",
       "      <th>Status</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>70870</td>\n",
       "      <td>222111</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>기타</td>\n",
       "      <td>-</td>\n",
       "      <td>Under Inspection</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>70869</td>\n",
       "      <td>221232</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>기타</td>\n",
       "      <td>-</td>\n",
       "      <td>Under Inspection</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>70868</td>\n",
       "      <td>221356</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>성북구</td>\n",
       "      <td>-</td>\n",
       "      <td>Under Inspection</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>70867</td>\n",
       "      <td>221710</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>동대문구</td>\n",
       "      <td>-</td>\n",
       "      <td>Under Inspection</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>70866</td>\n",
       "      <td>220502</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>타시도</td>\n",
       "      <td>-</td>\n",
       "      <td>Known</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65</th>\n",
       "      <td>30005</td>\n",
       "      <td>95804</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>송파구</td>\n",
       "      <td>-</td>\n",
       "      <td>Known</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66</th>\n",
       "      <td>30004</td>\n",
       "      <td>95889</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>종로구</td>\n",
       "      <td>-</td>\n",
       "      <td>Under Inspection</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>67</th>\n",
       "      <td>30003</td>\n",
       "      <td>95799</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>중구</td>\n",
       "      <td>-</td>\n",
       "      <td>Known</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>68</th>\n",
       "      <td>30002</td>\n",
       "      <td>95872</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>종로구</td>\n",
       "      <td>-</td>\n",
       "      <td>Known</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>30001</td>\n",
       "      <td>95806</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>송파구</td>\n",
       "      <td>-</td>\n",
       "      <td>Known</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>40870 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Number Patient Confimed Date  Area Travel History Transmission Route  \\\n",
       "0    70870  222111    2021-08-13    기타              -   Under Inspection   \n",
       "1    70869  221232    2021-08-13    기타              -   Under Inspection   \n",
       "2    70868  221356    2021-08-13   성북구              -   Under Inspection   \n",
       "3    70867  221710    2021-08-13  동대문구              -   Under Inspection   \n",
       "4    70866  220502    2021-08-13   타시도              -              Known   \n",
       "..     ...     ...           ...   ...            ...                ...   \n",
       "65   30005   95804    2021-03-14   송파구              -              Known   \n",
       "66   30004   95889    2021-03-14   종로구              -   Under Inspection   \n",
       "67   30003   95799    2021-03-14    중구              -              Known   \n",
       "68   30002   95872    2021-03-14   종로구              -              Known   \n",
       "69   30001   95806    2021-03-14   송파구              -              Known   \n",
       "\n",
       "         Status  \n",
       "0   Quarantined  \n",
       "1   Quarantined  \n",
       "2   Quarantined  \n",
       "3   Quarantined  \n",
       "4   Quarantined  \n",
       "..          ...  \n",
       "65    Recovered  \n",
       "66    Recovered  \n",
       "67    Recovered  \n",
       "68    Recovered  \n",
       "69    Recovered  \n",
       "\n",
       "[40870 rows x 7 columns]"
      ]
     },
     "execution_count": 485,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_all.loc[df_all[\"Transmission Route\"].str.contains(\"조사중\"), \"Transmission Route\"] = \"Under Inspection\"\n",
    "df_all.loc[df_all[\"Transmission Route\"].str.contains(\"접촉|관련\"), \"Transmission Route\"] = \"Known\"\n",
    "df_all.loc[df_all[\"Transmission Route\"].str.contains(\"해외\"), \"Transmission Route\"] = \"International\"\n",
    "df_all.loc[~df_all[\"Transmission Route\"].str.contains(\"Under Inspection|Known|International\"), \"Transmission Route\"] = \"Unknown\"\n",
    "df_all"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 486,
   "id": "372ebe34",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_all.loc[df_all[\"Area\"].str.contains(\"종로구\"), \"Area\"] = \"Jongno-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"중구\"), \"Area\"] = \"Jung-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"용산구\"), \"Area\"] = \"Yongsan-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"성동구\"), \"Area\"] = \"Seongdong-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"광진구\"), \"Area\"] = \"Gwangjin-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"동대문구\"), \"Area\"] = \"Dongdaemun-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"중랑구\"), \"Area\"] = \"Jungnang-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"성북구\"), \"Area\"] = \"Seongbuk-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"강북구\"), \"Area\"] = \"angbuk-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"도봉구\"), \"Area\"] = \"Dobong-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"노원구\"), \"Area\"] = \"Nowon-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"은평구\"), \"Area\"] = \"Eunpyeong-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"서대문구\"), \"Area\"] = \"Seodaemun-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"마포구\"), \"Area\"] = \"Mapo-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"양천구\"), \"Area\"] = \"Yangcheon-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"강서구\"), \"Area\"] = \"Gangseo-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"구로구\"), \"Area\"] = \"Guro-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"금천구\"), \"Area\"] = \"Geumcheon-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"영등포구\"), \"Area\"] = \"Yeongdeungpo-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"동작구\"), \"Area\"] = \"Dongjak-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"관악구\"), \"Area\"] = \"Gwanak-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"서초구\"), \"Area\"] = \"Seocho-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"강남구\"), \"Area\"] = \"Gangnam-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"송파구\"), \"Area\"] = \"Songpa-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"강동구\"), \"Area\"] = \"Gangdong-gu\"\n",
    "df_all.loc[df_all[\"Area\"].str.contains(\"타시도|기타\"), \"Area\"] = \"Another City\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 487,
   "id": "c4d792ba",
   "metadata": {},
   "outputs": [],
   "source": [
    "file_name = 'covid_19_recent_data.csv'\n",
    "df_all.to_csv(file_name, index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 488,
   "id": "d0a63b6b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Number</th>\n",
       "      <th>Patient</th>\n",
       "      <th>Confimed Date</th>\n",
       "      <th>Area</th>\n",
       "      <th>Travel History</th>\n",
       "      <th>Transmission Route</th>\n",
       "      <th>Status</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>70870</td>\n",
       "      <td>222111</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>Another City</td>\n",
       "      <td>-</td>\n",
       "      <td>Under Inspection</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>70869</td>\n",
       "      <td>221232</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>Another City</td>\n",
       "      <td>-</td>\n",
       "      <td>Under Inspection</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>70868</td>\n",
       "      <td>221356</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>Seongbuk-gu</td>\n",
       "      <td>-</td>\n",
       "      <td>Under Inspection</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>70867</td>\n",
       "      <td>221710</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>Dongdaemun-gu</td>\n",
       "      <td>-</td>\n",
       "      <td>Under Inspection</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>70866</td>\n",
       "      <td>220502</td>\n",
       "      <td>2021-08-13</td>\n",
       "      <td>Another City</td>\n",
       "      <td>-</td>\n",
       "      <td>Known</td>\n",
       "      <td>Quarantined</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40865</th>\n",
       "      <td>30005</td>\n",
       "      <td>95804</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>Songpa-gu</td>\n",
       "      <td>-</td>\n",
       "      <td>Known</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40866</th>\n",
       "      <td>30004</td>\n",
       "      <td>95889</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>Jongno-gu</td>\n",
       "      <td>-</td>\n",
       "      <td>Under Inspection</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40867</th>\n",
       "      <td>30003</td>\n",
       "      <td>95799</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>Jung-gu</td>\n",
       "      <td>-</td>\n",
       "      <td>Known</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40868</th>\n",
       "      <td>30002</td>\n",
       "      <td>95872</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>Jongno-gu</td>\n",
       "      <td>-</td>\n",
       "      <td>Known</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40869</th>\n",
       "      <td>30001</td>\n",
       "      <td>95806</td>\n",
       "      <td>2021-03-14</td>\n",
       "      <td>Songpa-gu</td>\n",
       "      <td>-</td>\n",
       "      <td>Known</td>\n",
       "      <td>Recovered</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>40870 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Number  Patient Confimed Date           Area Travel History  \\\n",
       "0       70870   222111    2021-08-13   Another City              -   \n",
       "1       70869   221232    2021-08-13   Another City              -   \n",
       "2       70868   221356    2021-08-13    Seongbuk-gu              -   \n",
       "3       70867   221710    2021-08-13  Dongdaemun-gu              -   \n",
       "4       70866   220502    2021-08-13   Another City              -   \n",
       "...       ...      ...           ...            ...            ...   \n",
       "40865   30005    95804    2021-03-14      Songpa-gu              -   \n",
       "40866   30004    95889    2021-03-14      Jongno-gu              -   \n",
       "40867   30003    95799    2021-03-14        Jung-gu              -   \n",
       "40868   30002    95872    2021-03-14      Jongno-gu              -   \n",
       "40869   30001    95806    2021-03-14      Songpa-gu              -   \n",
       "\n",
       "      Transmission Route       Status  \n",
       "0       Under Inspection  Quarantined  \n",
       "1       Under Inspection  Quarantined  \n",
       "2       Under Inspection  Quarantined  \n",
       "3       Under Inspection  Quarantined  \n",
       "4                  Known  Quarantined  \n",
       "...                  ...          ...  \n",
       "40865              Known    Recovered  \n",
       "40866   Under Inspection    Recovered  \n",
       "40867              Known    Recovered  \n",
       "40868              Known    Recovered  \n",
       "40869              Known    Recovered  \n",
       "\n",
       "[40870 rows x 7 columns]"
      ]
     },
     "execution_count": 488,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.read_csv(file_name)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
